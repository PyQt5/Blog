{"author":"Irony","title":"PyQt5仿网页图片鼠标移动特效","slug":"likehtmleffect","date":"2018-10-23 17:57:03","updated":"2019-10-20T15:56:56.034Z","comments":true,"path":"api/articles/likehtmleffect.json","url":"https://pyqt5.com/likehtmleffect.html","excerpt":"em，就是类似于那种游戏官网首页的图片，鼠标放上去后来回移动，图片的前景和背景错位移动。<br>","covers":["https://github.com/PyQt5/PyQt/raw/master/QLabel/ScreenShot/ImageSlipped.gif"],"content":"<p>em，就是类似于那种游戏官网首页的图片，鼠标放上去后来回移动，图片的前景和背景错位移动。<br><a id=\"more\"></a></p>\n<h2 id=\"原理分析\"><a href=\"#原理分析\" class=\"headerlink\" title=\"原理分析\"></a>原理分析</h2><ol>\n<li>2张一样大小的透明图片，1张作为背景，一张作为前景（比如说人物）。</li>\n<li>当鼠标往左移动时，前景人物跟着往左移动，背景往右移动</li>\n<li>计算好偏移量（见代码中）</li>\n</ol>\n<p><a href=\"https://github.com/PyQt5/PyQt/blob/master/QLabel/ImageSlipped.py\" target=\"_blank\" rel=\"noopener\">https://github.com/PyQt5/PyQt/blob/master/QLabel/ImageSlipped.py</a></p>\n<h2 id=\"关键代码\"><a href=\"#关键代码\" class=\"headerlink\" title=\"关键代码\"></a>关键代码</h2><pre><code class=\"python\">#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\n&quot;&quot;&quot;\nCreated on 2018年10月18日\n@author: Irony\n@site: https://pyqt5.com https://github.com/892768447\n@email: 892768447@qq.com\n@file: ImageSlipped\n@description: \n&quot;&quot;&quot;\nfrom PyQt5.QtGui import QPixmap, QPainter\nfrom PyQt5.QtWidgets import QWidget\n\n\n__Author__ = &quot;&quot;&quot;By: Irony\nQQ: 892768447\nEmail: 892768447@qq.com&quot;&quot;&quot;\n__Copyright__ = &quot;Copyright (c) 2018 Irony&quot;\n__Version__ = &quot;Version 1.0&quot;\n\n\nclass SlippedImgWidget(QWidget):\n\n    def __init__(self, bg, fg, *args, **kwargs):\n        super(SlippedImgWidget, self).__init__(*args, **kwargs)\n        # 开启鼠标跟踪\n        self.setMouseTracking(True)\n        # 背景\n        self.bgPixmap = QPixmap(bg)\n        # 前景\n        self.pePixmap = QPixmap(fg)\n        # 最小尺寸(背景右边和下方隐藏10个像素)\n        size = self.bgPixmap.size()\n        self.setMinimumSize(size.width() - 10, size.height() - 10)\n        self.setMaximumSize(size.width() - 10, size.height() - 10)\n        # 分成10份用于鼠标移动判断\n        self.stepX = size.width() / 10\n        self.stepY = size.height() / 10\n        # 偏移量\n        self._offsets = [-4, -4, -4, -4]  # 背景(-4,-4),前景(-4,-4)\n\n    def mouseMoveEvent(self, event):\n        super(SlippedImgWidget, self).mouseMoveEvent(event)\n        pos = event.pos()\n\n        # 偏移量\n        offsetX = 5 - int(pos.x() / self.stepX)\n        offsetY = 5 - int(pos.y() / self.stepY)\n        self._offsets[0] = offsetX\n        self._offsets[1] = offsetY\n        self._offsets[2] = offsetX\n        self._offsets[3] = offsetY\n        # 刷新\n        self.update()\n\n    def paintEvent(self, event):\n        super(SlippedImgWidget, self).paintEvent(event)\n        # 绘制图形\n        painter = QPainter(self)\n        painter.setRenderHint(QPainter.Antialiasing)\n        # 左上角偏移5个像素画背景图片\n        painter.drawPixmap(\n            -5 + self._offsets[0],\n            -5 + self._offsets[1], self.bgPixmap)\n        # 右下角偏移5个像素画前景图片\n        painter.drawPixmap(\n            self.width() - self.pePixmap.width() + 5 - self._offsets[2],\n            self.height() - self.pePixmap.height() + 5 - self._offsets[3],\n            self.pePixmap\n        )\n\n\nif __name__ == &#39;__main__&#39;:\n    import sys\n    from PyQt5.QtWidgets import QApplication\n    app = QApplication(sys.argv)\n    w = SlippedImgWidget(&#39;images/bg.png&#39;, &#39;images/fg.png&#39;)\n    w.show()\n    sys.exit(app.exec_())\n</code></pre>\n<h2 id=\"效果图\"><a href=\"#效果图\" class=\"headerlink\" title=\"效果图\"></a>效果图</h2><p><img src=\"https://github.com/PyQt5/PyQt/raw/master/QLabel/ScreenShot/ImageSlipped.gif\" alt=\"ImageSlipped\"></p>\n","raw":"---\nauthor: Irony\ntitle: PyQt5仿网页图片鼠标移动特效\ndate: 2018-10-23 17:57:03\ntop: 1\ntags: \n - PyQt\n - 特效\ncategories: 例子\n---\n\nem，就是类似于那种游戏官网首页的图片，鼠标放上去后来回移动，图片的前景和背景错位移动。\n<!-- more -->\n\n## 原理分析\n\n1. 2张一样大小的透明图片，1张作为背景，一张作为前景（比如说人物）。\n2. 当鼠标往左移动时，前景人物跟着往左移动，背景往右移动\n3. 计算好偏移量（见代码中）\n\nhttps://github.com/PyQt5/PyQt/blob/master/QLabel/ImageSlipped.py\n\n## 关键代码\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\n\"\"\"\nCreated on 2018年10月18日\n@author: Irony\n@site: https://pyqt5.com https://github.com/892768447\n@email: 892768447@qq.com\n@file: ImageSlipped\n@description: \n\"\"\"\nfrom PyQt5.QtGui import QPixmap, QPainter\nfrom PyQt5.QtWidgets import QWidget\n\n\n__Author__ = \"\"\"By: Irony\nQQ: 892768447\nEmail: 892768447@qq.com\"\"\"\n__Copyright__ = \"Copyright (c) 2018 Irony\"\n__Version__ = \"Version 1.0\"\n\n\nclass SlippedImgWidget(QWidget):\n\n    def __init__(self, bg, fg, *args, **kwargs):\n        super(SlippedImgWidget, self).__init__(*args, **kwargs)\n        # 开启鼠标跟踪\n        self.setMouseTracking(True)\n        # 背景\n        self.bgPixmap = QPixmap(bg)\n        # 前景\n        self.pePixmap = QPixmap(fg)\n        # 最小尺寸(背景右边和下方隐藏10个像素)\n        size = self.bgPixmap.size()\n        self.setMinimumSize(size.width() - 10, size.height() - 10)\n        self.setMaximumSize(size.width() - 10, size.height() - 10)\n        # 分成10份用于鼠标移动判断\n        self.stepX = size.width() / 10\n        self.stepY = size.height() / 10\n        # 偏移量\n        self._offsets = [-4, -4, -4, -4]  # 背景(-4,-4),前景(-4,-4)\n\n    def mouseMoveEvent(self, event):\n        super(SlippedImgWidget, self).mouseMoveEvent(event)\n        pos = event.pos()\n\n        # 偏移量\n        offsetX = 5 - int(pos.x() / self.stepX)\n        offsetY = 5 - int(pos.y() / self.stepY)\n        self._offsets[0] = offsetX\n        self._offsets[1] = offsetY\n        self._offsets[2] = offsetX\n        self._offsets[3] = offsetY\n        # 刷新\n        self.update()\n\n    def paintEvent(self, event):\n        super(SlippedImgWidget, self).paintEvent(event)\n        # 绘制图形\n        painter = QPainter(self)\n        painter.setRenderHint(QPainter.Antialiasing)\n        # 左上角偏移5个像素画背景图片\n        painter.drawPixmap(\n            -5 + self._offsets[0],\n            -5 + self._offsets[1], self.bgPixmap)\n        # 右下角偏移5个像素画前景图片\n        painter.drawPixmap(\n            self.width() - self.pePixmap.width() + 5 - self._offsets[2],\n            self.height() - self.pePixmap.height() + 5 - self._offsets[3],\n            self.pePixmap\n        )\n\n\nif __name__ == '__main__':\n    import sys\n    from PyQt5.QtWidgets import QApplication\n    app = QApplication(sys.argv)\n    w = SlippedImgWidget('images/bg.png', 'images/fg.png')\n    w.show()\n    sys.exit(app.exec_())\n```\n\n## 效果图\n\n![ImageSlipped](https://github.com/PyQt5/PyQt/raw/master/QLabel/ScreenShot/ImageSlipped.gif)","categories":[{"name":"例子","path":"api/categories/例子.json"}],"tags":[{"name":"PyQt","path":"api/tags/PyQt.json"},{"name":"特效","path":"api/tags/特效.json"}]}